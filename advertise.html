<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Advertise on The Property Brief — Reach Malaysia's Property Audience</title>
  <meta name="description" content="The only Malaysian property platform with live, transparent GA4 audience data and an open ad-bidding system. Reach property buyers, investors, and industry professionals. View real traffic data and place your bid." />
  <meta name="keywords" content="advertise property Malaysia, real estate advertising Malaysia, property media kit Malaysia, Malaysian property audience, property digital advertising, advertise property platform Malaysia" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://thepropertybrief.org/advertise.html" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://thepropertybrief.org/advertise.html" />
  <meta property="og:title" content="Advertise on The Property Brief — Live Data. Open Bidding." />
  <meta property="og:description" content="The only Malaysian property platform with live, transparent GA4 audience data and an open ad-bidding system. See the real audience before you bid." />
  <meta property="og:image" content="https://thepropertybrief.org/og-image.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:locale" content="en_MY" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Advertise on The Property Brief — Live Data. Open Bidding." />
  <meta name="twitter:description" content="Malaysia's only property platform with live GA4 audience data and transparent ad bidding. See the real numbers before you spend." />
  <meta name="twitter:image" content="https://thepropertybrief.org/og-image.jpg" />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

  <!-- Stylesheet -->
  <link rel="stylesheet" href="/styles.css" />

  <style>
    /* Stats Grid — UNCHANGED */
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 24px; }
    .stat-card { background: #111; border: 1px solid #2a2a2a; border-radius: 12px; padding: 20px; text-align: center; }
    .stat-label { font-size: 0.8rem; color: #888; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px; }
    .stat-value { font-size: 2rem; font-weight: 800; color: #f5c800; line-height: 1.1; }

    /* Responsive Iframe — UNCHANGED */
    .iframe-container { position: relative; width: 100%; overflow: hidden; border-radius: 12px; border: 1px solid #2a2a2a; background: #111; margin-top: 24px; }
    .iframe-container iframe { width: 100%; height: 600px; border: none; }

    /* Ad Slots Table — UNCHANGED */
    .table-responsive { overflow-x: auto; margin-top: 24px; border-radius: 12px; border: 1px solid #2a2a2a; }
    .ad-table { width: 100%; border-collapse: collapse; min-width: 700px; font-size: 0.9rem; }
    .ad-table th { background: #111; color: #f5c800; text-align: left; padding: 14px 16px; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 1px solid #2a2a2a; }
    .ad-table td { padding: 14px 16px; border-bottom: 1px solid #2a2a2a; color: #ddd; vertical-align: middle; }
    .ad-table tr:last-child td { border-bottom: none; }
    .ad-table tr:hover td { background: rgba(255,255,255,0.02); }

    /* Badges — UNCHANGED */
    .badge { display: inline-block; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
    .badge.available { background: #0d2a0d; border: 1px solid #2e7d2e; color: #81c784; }
    .badge.bidding { background: #2a1f00; border: 1px solid #7d5a00; color: #ffa726; }
    .badge.occupied { background: #1a1a1a; border: 1px solid #333; color: #777; }

    /* Form — UNCHANGED */
    .ad-form { background: #111; padding: 24px; border-radius: 12px; border: 1px solid #2a2a2a; margin-top: 24px; }
    .form-group { margin-bottom: 16px; }
    .form-label { display: block; font-size: 0.85rem; color: #aaa; margin-bottom: 6px; font-weight: 600; }
    .form-input { width: 100%; background: #0b0b0c; border: 1px solid #333; border-radius: 8px; color: #fff; padding: 12px; font-size: 0.95rem; outline: none; transition: border-color 0.2s; }
    .form-input:focus { border-color: #f5c800; }

    /* Why Advertise cards — NEW */
    .why-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; margin-top: 1.5rem; }
    .why-card { background: rgba(255,255,255,0.03); border: 1px solid #2a2a2a; border-radius: 12px; padding: 1.25rem 1.5rem; }
    .why-card h3 { font-size: 0.95rem; margin: 0 0 0.5rem; color: #f5c800; }
    .why-card p { font-size: 0.88rem; color: #aaa; margin: 0; line-height: 1.7; }

    /* How It Works steps — NEW */
    .steps { display: flex; flex-direction: column; gap: 1rem; margin-top: 1.5rem; }
    .step { display: flex; gap: 1rem; align-items: flex-start; }
    .step-num { flex-shrink: 0; width: 32px; height: 32px; border-radius: 50%; background: #f5c800; color: #000; font-weight: 800; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; margin-top: 2px; }
    .step-body h3 { font-size: 0.95rem; margin: 0 0 0.3rem; color: #fff; }
    .step-body p { font-size: 0.88rem; color: #aaa; margin: 0; line-height: 1.7; }

    /* Action button in table — NEW */
    .btnAction { background: #f5c800; color: #000; font-weight: 800; border: none; border-radius: 6px; padding: 8px 18px; cursor: pointer; font-size: 0.82rem; white-space: nowrap; transition: opacity 0.2s; }
    .btnAction:hover { opacity: 0.85; }
    .btnAction.bid { background: transparent; color: #ffa726; border: 1px solid #ffa726; }
    .btnAction.bid:hover { background: rgba(255,167,38,0.08); }
    .btnAction:disabled { opacity: 0.35; cursor: not-allowed; }

    /* Form section toggle — NEW */
    #formSection { scroll-margin-top: 80px; }
    .form-section-header { display: flex; align-items: flex-start; justify-content: space-between; gap: 12px; margin-bottom: 1rem; flex-wrap: wrap; }
    .slot-chip { display: inline-block; background: rgba(245,200,0,0.1); border: 1px solid rgba(245,200,0,0.3); color: #f5c800; border-radius: 20px; padding: 4px 14px; font-size: 0.8rem; font-weight: 700; white-space: nowrap; }
    #cancelFormBtn { background: transparent; color: #666; font-weight: 600; border: 1px solid #2a2a2a; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-size: 0.9rem; transition: border-color 0.2s; }
    #cancelFormBtn:hover { border-color: #555; color: #aaa; }
    .image-hint { color: #555; font-size: 0.78rem; margin-top: 5px; display: block; line-height: 1.5; }
    input[type="date"].form-input::-webkit-calendar-picker-indicator { filter: invert(0.5); cursor: pointer; }

  </style>

  <script type="application/ld+json">
  [
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "Advertise on The Property Brief",
      "url": "https://thepropertybrief.org/advertise.html",
      "description": "Media kit and transparent ad slot bidding page for The Property Brief — Malaysia's only property platform with live GA4 audience data and an open bidding system.",
      "publisher": {
        "@type": "Organization",
        "name": "The Property Brief",
        "url": "https://thepropertybrief.org",
        "logo": {
          "@type": "ImageObject",
          "url": "https://thepropertybrief.org/android-chrome-512x512.png"
        }
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "How do I advertise on The Property Brief?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "To advertise on The Property Brief, browse the live audience data on this page, review the available ad slot inventory, and submit a bid using the form at the bottom of the page. We reply within 1 business day to confirm availability and next steps."
          }
        },
        {
          "@type": "Question",
          "name": "What ad formats are available on The Property Brief?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The Property Brief offers five ad placements: Homepage Hero Banner (desktop 1200x260px and mobile 750x260px), Calculator Top Banner (900x120px, above the finance simulator form), Calculator Mid Banner (900x120px, after the Calculate button), and Listing Hero Slider (1440x480px on the projects page). All placements run on a 2-week duration with rotating slots supporting up to 5 advertisers per placement."
          }
        },
        {
          "@type": "Question",
          "name": "How does the ad bidding system work on The Property Brief?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The Property Brief uses an open, transparent bidding system. Each ad slot supports up to 5 rotating advertisers on a 14-day cycle. When slots are available, advertisers can book directly. When a slot is full, a queue bidding system activates — the current highest bid is visible to all, and the highest bidder in the queue is automatically notified 24 hours before the next slot opens."
          }
        },
        {
          "@type": "Question",
          "name": "What audience does The Property Brief reach?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The Property Brief reaches Malaysian property buyers, investors, real estate agents, and industry professionals. The full audience breakdown — including total users, sessions, session duration, device type, and top cities — is published live on the advertising page via an embedded Google Analytics dashboard, updated daily."
          }
        }
      ]
    }
  ]
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CR7KQDF1JX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-CR7KQDF1JX');
  </script>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <a href="/" aria-label="The Property Brief Home">
        <img src="/assets/Logo TPB White.png" alt="The Property Brief" class="logo" />
      </a>
    </div>
    <button class="hamburger" id="hamburger" type="button" aria-label="Toggle menu">
      <span></span><span></span><span></span>
    </button>
    <nav class="nav" id="mainNav">
      <a href="/">Home</a>
      <a href="/#latest">News</a>
      <a href="/#strategies">Strategies</a>
      <a href="/#search">Search</a>
      <a href="/projects.html">Listings</a>
      
      <div class="toolsDropdown">
        <button class="toolsBtn" type="button" aria-expanded="false" aria-haspopup="true">
          About <span class="toolsArrow" aria-hidden="true">▾</span>
        </button>
        <div class="toolsPanel" role="menu">
          <a href="/about.html" class="toolsItem" role="menuitem">
            <span class="toolsText">
              <strong>About Us</strong>
              <span>Who we are & standards</span>
            </span>
          </a>
          <a href="/advertise.html" class="toolsItem" role="menuitem" aria-current="page">
            <span class="toolsText">
              <strong style="color:#f9d100;">Advertise</strong>
              <span>Media kit & ad slots</span>
            </span>
          </a>
        </div>
      </div>

      <div class="toolsDropdown">
        <button class="toolsBtn" type="button" aria-expanded="false" aria-haspopup="true">
          Tools <span class="toolsArrow" aria-hidden="true">▾</span>
        </button>
        <div class="toolsPanel" role="menu">
          <a href="/calculator.html" class="toolsItem" role="menuitem">
            <span class="toolsText">
              <strong>Mortgage Calculator</strong>
              <span>Full finance &amp; DSR tool</span>
            </span>
          </a>
          <div class="toolsItem toolsComingSoon" aria-disabled="true">
            <span class="toolsText">
              <strong>Image Resizer</strong>
              <span>Coming soon</span>
            </span>
          </div>
          <div class="toolsItem toolsComingSoon" aria-disabled="true">
            <span class="toolsText">
              <strong>PDF Creator</strong>
              <span>Coming soon</span>
            </span>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <main class="container" style="padding-top:2.5rem; padding-bottom:4rem;">
    <div class="maincol">

      <section style="margin-bottom:3rem;">
        <p class="kicker">Transparent by Design</p>
        <h1 style="margin-bottom:1rem; color:#f5c800;">Reach Malaysia's Property Audience</h1>
        <p class="sub">
          The only Malaysian property platform that shows you the real audience data before you spend a single ringgit. No polished PDFs. No inflated numbers. Just live GA4 traffic — and an open bidding system where every advertiser starts on equal footing.
        </p>
      </section>

      <!-- Why Advertise Here -->
      <section style="margin-bottom:3rem;">
        <h2>Why Advertise Here</h2>
        <p class="muted">Three things that make The Property Brief different from every other Malaysian property media platform.</p>
        <div class="why-grid">
          <div class="why-card">
            <h3>An Informed Audience</h3>
            <p>Our readers are not casual scrollers. They are actively researching property purchases, tracking market movements, or making professional decisions. Your ad reaches people at the moment of intent.</p>
          </div>
          <div class="why-card">
            <h3>Total Transparency</h3>
            <p>We publish our full GA4 traffic data live on this page — unedited, directly from Google Analytics. You see exactly what we see before committing to a single ringgit. No other Malaysian property platform does this.</p>
          </div>
          <div class="why-card">
            <h3>Open &amp; Fair Bidding</h3>
            <p>No opaque media kits. No fixed, inflated rate cards. Every ad slot is open to competitive bidding — prices are set by the market. Small developers and large agencies compete on equal terms.</p>
          </div>
        </div>
      </section>

      <!-- How It Works -->
      <section style="margin-bottom:3rem;">
        <h2>How It Works</h2>
        <p class="muted">Two steps are always the same. Step 3 depends on whether the slot is available right now or full.</p>
        <div class="steps">

          <div class="step">
            <div class="step-num">1</div>
            <div class="step-body">
              <h3>Browse the live audience data</h3>
              <p>Scroll down to the Live Audience Data section. Review real, unedited GA4 traffic for the last 30 days — total users, sessions, top cities, device breakdown, and top pages. What you see is exactly what we see.</p>
            </div>
          </div>

          <div class="step">
            <div class="step-num">2</div>
            <div class="step-body">
              <h3>Find your slot in the inventory table</h3>
              <p>Check the Ad Slot Inventory below. Each slot shows its page location, banner dimensions, current fill count (out of 5), and live status. Then follow the path that matches your slot's status.</p>
            </div>
          </div>

          <!-- Path A -->
          <div class="step">
            <div class="step-num" style="background:#81c784; color:#000;">A</div>
            <div class="step-body">
              <h3>Slot is <span style="color:#81c784;">Available</span> — Book it now at the base price</h3>
              <p>Click <strong>Book Now</strong>. Choose your preferred start date, upload your banner image, enter your destination URL, and pay the fixed base price. No bidding, no waiting. Your ad goes live on your chosen date and runs for exactly 14 days. We confirm and collect payment within 1 business day.</p>
            </div>
          </div>

          <!-- Path B -->
          <div class="step">
            <div class="step-num" style="background:#ffa726; color:#000;">B</div>
            <div class="step-body">
              <h3>Slot is <span style="color:#ffa726;">Bidding Open</span> — Join the queue</h3>
              <p>Click <strong>Place Bid</strong>. The slot is currently full with 5 active advertisers. You are bidding for the next rotation — upload your banner image now, enter a bid higher than the current highest bid shown, and submit. The highest bidder is automatically selected 24 hours before a slot opens. If selected, you will receive an email with payment instructions. Once payment is confirmed, your ad goes live immediately when the previous ad expires — zero downtime.</p>
            </div>
          </div>

        </div>
      </section>

      <section style="margin-bottom:3rem;">
        <h2>Live Audience Data</h2>
        <p class="muted">
          We believe in total transparency. The dashboard below pulls live, unedited Google Analytics (GA4) traffic data directly from our site for the last 30 days. You see exactly what we see.
        </p>
        <div class="iframe-container">
          <iframe 
            src="https://lookerstudio.google.com/embed/reporting/5948f465-fcde-477f-8177-f1688ddbf1f2/page/1RopF" 
            frameborder="0" 
            style="border:0" 
            allowfullscreen>
          </iframe>
        </div>
      </section>

      <section style="margin-bottom:3rem;">
        <h2>Ad Slot Inventory</h2>
        <p class="muted">All placements run for 14 days. Click <strong style="color:#81c784;">Book Now</strong> to buy at the base price, or <strong style="color:#ffa726;">Place Bid</strong> to join the queue for the next available slot.</p>
        
        <div class="table-responsive">
          <table class="ad-table">
            <thead>
              <tr>
                <th>Slot</th>
                <th>Location</th>
                <th>Dimensions</th>
                <th>Price</th>
                <th>Status</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="slotTableBody">
              <tr><td colspan="6" style="text-align:center;color:#555;padding:32px 16px;">Loading live slot data…</td></tr>
            </tbody>
          </table>
        </div>
      </section>

            <section id="formSection" style="display:none; margin-bottom:3rem;">
        <div class="form-section-header">
          <div>
            <h2 id="formTitle" style="margin-bottom:0.4rem;">Book This Slot</h2>
            <span class="slot-chip" id="slotChip"></span>
          </div>
          <button type="button" id="cancelFormBtn">✕ Cancel</button>
        </div>
        <p class="muted" id="formSubtitle" style="margin-bottom:1.5rem;"></p>

        <div class="ad-form">
          <form id="adBidForm">
            <input type="hidden" id="fieldSlotId" name="slot_id" />
            <input type="hidden" id="fieldFormType" name="form_type" value="direct" />

            <!-- Row 1: Name + Email -->
            <div class="stats-grid" style="margin-top:0;">
              <div class="form-group">
                <label class="form-label" for="fieldName">Your Name *</label>
                <input type="text" id="fieldName" name="name" class="form-input" required placeholder="Ahmad or Sara" />
              </div>
              <div class="form-group">
                <label class="form-label" for="fieldEmail">Email *</label>
                <input type="email" id="fieldEmail" name="email" class="form-input" required placeholder="you@company.com" />
              </div>
            </div>

            <!-- Row 2: WhatsApp + Bid Amount -->
            <div class="stats-grid" style="margin-top:0;">
              <div class="form-group">
                <label class="form-label" for="fieldWhatsApp">WhatsApp Number *</label>
                <input type="text" id="fieldWhatsApp" name="whatsapp" class="form-input" required placeholder="e.g. 60123456789" />
              </div>
              <div class="form-group">
                <label class="form-label" id="bidLabel" for="fieldBid">Amount (RM) *</label>
                <input type="number" id="fieldBid" name="bid_amount" class="form-input" required placeholder="e.g. 150" />
              </div>
            </div>

            <!-- Direct Buy only: start date -->
            <div class="form-group" id="dateGroup" style="display:none;">
              <label class="form-label" for="fieldStartDate">Preferred Start Date *</label>
              <input type="date" id="fieldStartDate" name="start_date" class="form-input" />
              <small class="image-hint">Your ad will run for exactly 14 days from this date.</small>
            </div>

            <!-- Image uploads — 3 required (desktop / tablet / mobile) -->
            <div class="form-group">
              <label class="form-label">Banner Images <span style="color:#555;font-weight:400;">(3 required — one per device)</span></label>

              <div style="margin-bottom:14px;">
                <label class="form-label" for="fieldImageDesktop" style="color:#888;font-size:0.78rem;margin-bottom:4px;">Desktop Image *</label>
                <input type="file" id="fieldImageDesktop" name="image_desktop" class="form-input" accept="image/jpeg,image/jpg" required style="padding:10px;" />
                <small class="image-hint" id="hintDesktop">—</small>
              </div>

              <div style="margin-bottom:14px;">
                <label class="form-label" for="fieldImageTablet" style="color:#888;font-size:0.78rem;margin-bottom:4px;">Tablet Image *</label>
                <input type="file" id="fieldImageTablet" name="image_tablet" class="form-input" accept="image/jpeg,image/jpg" required style="padding:10px;" />
                <small class="image-hint" id="hintTablet">—</small>
              </div>

              <div>
                <label class="form-label" for="fieldImageMobile" style="color:#888;font-size:0.78rem;margin-bottom:4px;">Mobile Image *</label>
                <input type="file" id="fieldImageMobile" name="image_mobile" class="form-input" accept="image/jpeg,image/jpg" required style="padding:10px;" />
                <small class="image-hint" id="hintMobile">—</small>
              </div>
            </div>

            <!-- Row 3: Ad URL + Alt Text -->
            <div class="stats-grid" style="margin-top:0;">
              <div class="form-group">
                <label class="form-label" for="fieldAdUrl">Destination URL *</label>
                <input type="url" id="fieldAdUrl" name="ad_url" class="form-input" required placeholder="https://yourproject.com" />
              </div>
              <div class="form-group">
                <label class="form-label" for="fieldAltText">Alt Text / Caption</label>
                <input type="text" id="fieldAltText" name="alt_text" class="form-input" placeholder="Short description of your ad" />
              </div>
            </div>

            <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:10px;">
              <button type="submit" id="submitBidBtn" style="background:#f5c800;color:#000;font-weight:800;border:none;border-radius:8px;padding:14px 32px;cursor:pointer;font-size:1rem;transition:opacity 0.2s;">Submit</button>
              <button type="button" id="cancelFormBtn2" style="background:transparent;color:#666;font-weight:600;border:1px solid #2a2a2a;border-radius:8px;padding:14px 24px;cursor:pointer;font-size:1rem;">Cancel</button>
            </div>
          </form>

          <div id="bidSuccess" style="display:none;margin-top:24px;padding:20px 24px;background:#1a1a1a;border-left:4px solid #f5c800;border-radius:8px;">
            <strong style="color:#fff;display:block;font-size:1.1rem;margin-bottom:6px;">Sent Successfully</strong>
            <span style="color:#aaa;font-size:0.9rem;line-height:1.6;display:block;">Thank you. A confirmation email is on its way to you. Our admin will follow up within 1 business day.</span>
          </div>
        </div>
      </section>

    </div>
  </main>

    <footer class="footer">
    <small>© <span id="year"></span> THE PROPERTY BRIEF</small>
  </footer>

  <script src="/CONFIG.js"></script>
  <script src="/menu.js"></script>
    <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // ── Globals ──────────────────────────────────────────────
    let slotData = {};

    // Image specs per slot — used in form hints and spec table
    const SLOT_SPECS = {
      'hero-home': {
        desktop: '1200×400px · ratio 3:1 · max 500KB',
        tablet:  '1000×400px · ratio 2.5:1 · max 400KB',
        mobile:  '720×400px · ratio 1.8:1 · max 300KB',
      },
      'listing-hero': {
        desktop: '1920×480px · ratio 4:1 · max 800KB',
        tablet:  '1000×400px · ratio 2.5:1 · max 400KB',
        mobile:  '720×400px · ratio 1.8:1 · max 300KB',
      },
      'calc-top': {
        desktop: '900×120px · ratio 7.5:1 · max 200KB',
        tablet:  '720×120px · ratio 6:1 · max 150KB',
        mobile:  '480×120px · ratio 4:1 · max 100KB',
      },
      'calc-mid': {
        desktop: '900×120px · ratio 7.5:1 · max 200KB',
        tablet:  '720×120px · ratio 6:1 · max 150KB',
        mobile:  '480×120px · ratio 4:1 · max 100KB',
      },
    };

    // ── On page load: fetch live slot data ───────────────────
    document.addEventListener('DOMContentLoaded', loadSlotData);

    async function loadSlotData() {
      try {
        const res = await fetch(CONFIG.API.AD_BID_URL);
        slotData = await res.json();
        renderTable(slotData);
      } catch (err) {
        document.getElementById('slotTableBody').innerHTML =
          '<tr><td colspan="6" style="text-align:center;color:#888;padding:32px;">Could not load slot data — please refresh the page.</td></tr>';
      }
    }

    // ── Render table rows from live data ─────────────────────
    function renderTable(data) {
      const tbody = document.getElementById('slotTableBody');
      tbody.innerHTML = '';

      Object.values(data).forEach(slot => {
        const tr = document.createElement('tr');

        // Status badge
        let badge, action;
        if (slot.status === 'paused') {
          badge  = '<span class="badge occupied">Direct Deal</span>';
          action = '<span style="color:#444;font-size:0.8rem;">Unavailable</span>';
        } else if (slot.status === 'bidding') {
          badge  = '<span class="badge bidding">Bidding Open</span>';
          action = `<button class="btnAction bid" data-slot="${slot.slotId}" data-type="bid">Place Bid</button>`;
        } else {
          badge  = '<span class="badge available">Available</span>';
          action = `<button class="btnAction" data-slot="${slot.slotId}" data-type="direct">Book Now</button>`;
        }

        // Price cell
        let priceCell;
        if (slot.status === 'paused') {
          priceCell = '<span style="color:#444;">—</span>';
        } else if (slot.status === 'bidding') {
          priceCell = slot.highestBid > 0
            ? `<span style="color:#ffa726;font-weight:700;">Highest: RM ${slot.highestBid}</span><br><small style="color:#555;">Base RM ${slot.basePrice}</small>`
            : `<span style="color:#888;">No bids yet</span><br><small style="color:#555;">Base RM ${slot.basePrice}</small>`;
        } else {
          priceCell = `<span style="color:#81c784;font-weight:700;">RM ${slot.basePrice}</span>`;
        }

        tr.innerHTML = `
          <td>
            <strong>${slot.slotName}</strong>
            <br><small style="color:#444;">${slot.activeCount}/5 filled</small>
          </td>
          <td style="color:#666;">${slot.location}</td>
          <td style="color:#666;font-size:0.82rem;line-height:1.8;">${(slot.dimensions||'').replace(/·/g,'<br><span style="color:#444;">·</span>')}</td>
          <td>${priceCell}</td>
          <td>${badge}</td>
          <td>${action}</td>`;
        tbody.appendChild(tr);
      });

      // Attach button listeners
      tbody.querySelectorAll('.btnAction[data-slot]').forEach(btn => {
        btn.addEventListener('click', () => openForm(btn.dataset.slot, btn.dataset.type));
      });
    }

    // ── Open correct form for selected slot ──────────────────
    function openForm(slotId, type) {
      const slot        = slotData[slotId];
      const formSection = document.getElementById('formSection');
      const formTitle   = document.getElementById('formTitle');
      const formSubtitle= document.getElementById('formSubtitle');
      const slotChip    = document.getElementById('slotChip');
      const dateGroup   = document.getElementById('dateGroup');
      const bidLabel    = document.getElementById('bidLabel');
      const bidInput    = document.getElementById('fieldBid');
      const startInput  = document.getElementById('fieldStartDate');

      // Pre-fill hidden fields
      document.getElementById('fieldSlotId').value   = slotId;
      document.getElementById('fieldFormType').value = type;
      slotChip.textContent = slot.slotName;

      // Set today as min date for start date picker
      const todayStr = new Date().toISOString().split('T')[0];
      startInput.min = todayStr;
      startInput.value = todayStr;

const specs = SLOT_SPECS[slotId] || { desktop: '—', tablet: '—', mobile: '—' };
      document.getElementById('hintDesktop').textContent =
        `Desktop: ${specs.desktop} · JPEG only · keep text/logos in centre 60%`;
      document.getElementById('hintTablet').textContent =
        `Tablet: ${specs.tablet} · JPEG only · keep text/logos in centre 60%`;
      document.getElementById('hintMobile').textContent =
        `Mobile: ${specs.mobile} · JPEG only · keep text/logos in centre 60%`;

      if (type === 'direct') {
        formTitle.textContent   = 'Book This Slot';
        formSubtitle.textContent = `You are booking: ${slot.slotName} at the base price of RM ${slot.basePrice} for 14 days. Choose your preferred start date below.`;
        dateGroup.style.display = 'block';
        startInput.required     = true;
        bidLabel.textContent    = `Amount (RM ${slot.basePrice} fixed) *`;
        bidInput.value          = slot.basePrice;
        bidInput.readOnly       = true;
        bidInput.min            = slot.basePrice;
      } else {
        const minBid = slot.highestBid > 0 ? slot.highestBid + 1 : slot.basePrice;
        formTitle.textContent   = 'Place Your Bid';
        formSubtitle.textContent = slot.highestBid > 0
          ? `This slot is full. You are bidding for the next rotation. Current highest bid: RM ${slot.highestBid}. Your bid must be higher. The highest bidder is automatically selected 24 hours before a slot opens.`
          : `This slot is full. You are bidding for the next rotation. No bids yet — minimum bid is RM ${slot.basePrice}. The highest bidder is automatically selected 24 hours before a slot opens.`;
        dateGroup.style.display = 'none';
        startInput.required     = false;
        bidLabel.textContent    = `Your Bid (min RM ${minBid}) *`;
        bidInput.value          = '';
        bidInput.readOnly       = false;
        bidInput.min            = minBid;
      }

      // Reset form state
      document.getElementById('adBidForm').style.display = 'block';
      document.getElementById('bidSuccess').style.display = 'none';

      formSection.style.display = 'block';
      formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // ── Cancel buttons ────────────────────────────────────────
    ['cancelFormBtn','cancelFormBtn2'].forEach(id => {
      document.getElementById(id).addEventListener('click', () => {
        document.getElementById('formSection').style.display = 'none';
      });
    });

    // ── Compress image before upload ─────────────────────────
    function compressImage(file, maxWidth, quality) {
      return new Promise(resolve => {
        const reader = new FileReader();
        reader.onload = ev => {
          const img = new Image();
          img.onload = () => {
            const canvas = document.createElement('canvas');
            let w = img.width, h = img.height;
            if (w > maxWidth) { h = Math.round(h * maxWidth / w); w = maxWidth; }
            canvas.width = w; canvas.height = h;
            canvas.getContext('2d').drawImage(img, 0, 0, w, h);
            resolve(canvas.toDataURL('image/jpeg', quality));
          };
          img.src = ev.target.result;
        };
        reader.readAsDataURL(file);
      });
    }

    // ── Form submission ───────────────────────────────────────
    document.getElementById('adBidForm').addEventListener('submit', async e => {
      e.preventDefault();
      const btn        = document.getElementById('submitBidBtn');
      const successMsg = document.getElementById('bidSuccess');

      btn.textContent = 'Sending…';
      btn.disabled    = true;

      try {
        const imageDesktopFile = document.getElementById('fieldImageDesktop').files[0];
        const imageTabletFile  = document.getElementById('fieldImageTablet').files[0];
        const imageMobileFile  = document.getElementById('fieldImageMobile').files[0];

        let imageDesktopB64 = '', imageTabletB64 = '', imageMobileB64 = '';
        if (imageDesktopFile) imageDesktopB64 = await compressImage(imageDesktopFile, 1400, 0.85);
        if (imageTabletFile)  imageTabletB64  = await compressImage(imageTabletFile,  1100, 0.85);
        if (imageMobileFile)  imageMobileB64  = await compressImage(imageMobileFile,   800, 0.85);

        const formData = new FormData();
        formData.append('slot_id',      document.getElementById('fieldSlotId').value);
        formData.append('form_type',    document.getElementById('fieldFormType').value);
        formData.append('name',         document.getElementById('fieldName').value);
        formData.append('email',        document.getElementById('fieldEmail').value);
        formData.append('whatsapp',     document.getElementById('fieldWhatsApp').value);
        formData.append('bid_amount',   document.getElementById('fieldBid').value);
        formData.append('ad_url',       document.getElementById('fieldAdUrl').value);
        formData.append('alt_text',     document.getElementById('fieldAltText').value);
        formData.append('image_desktop_base64', imageDesktopB64);
        formData.append('image_tablet_base64',  imageTabletB64);
        formData.append('image_mobile_base64',  imageMobileB64);
        if (document.getElementById('fieldFormType').value === 'direct') {
          formData.append('start_date', document.getElementById('fieldStartDate').value);
        }

        const res = await fetch(CONFIG.API.AD_BID_URL, { method: 'POST', body: formData });

        if (res.ok) {
          document.getElementById('adBidForm').style.display = 'none';
          successMsg.style.display = 'block';
          setTimeout(() => {
            document.getElementById('formSection').style.display = 'none';
            successMsg.style.display = 'none';
            document.getElementById('adBidForm').reset();
            document.getElementById('adBidForm').style.display = 'block';
          }, 6000);
        } else {
          throw new Error('Server error');
        }
      } catch (err) {
        alert('Sorry — something went wrong. Please check your connection and try again.');
      } finally {
        btn.textContent = 'Submit';
        btn.disabled    = false;
      }
    });
  </script>

</body>
</html>